(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[741],{74793:function(e,t,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/cp/project",function(){return i(4949)}])},4949:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return $}});var n=i(85893),l=i(61342),r=i(21676),s=i(21033),c=i(31704),o=i(21248),a=i(39080),d=i(41533),u=i(37206),h=i(80016),x=i(51233),j=i(53252),m=i(67294),f=i(37763),p=i.n(f),_=i(4480),b=i(23339),w=i(5925),v=i(98312),y=i(42180),g=i(5616),Z=i(15861),k=i(20025);let C=()=>{let[e,t]=(0,_.useRecoilState)(d.NS),i=(0,_.useRecoilValue)(w.m),l=async()=>{await (0,b.u7)(i&&(null==i?void 0:i.id)?null==i?void 0:i.id:0),t(!1)};return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(y.Z,{open:e,onClose:()=>{t(!e)},children:(0,n.jsxs)(g.Z,{textAlign:"center",children:[(0,n.jsx)(v.Z,{height:60,width:60,color:k.Z[600]}),(0,n.jsxs)(Z.Z,{children:["Do you want delete this project ",(0,n.jsxs)("strong",{children:['"#',(0,h.vX)(null==i?void 0:i.id),'"?']})]}),(0,n.jsxs)(x.Z,{direction:"row",spacing:2,justifyContent:"center",pt:2,children:[(0,n.jsx)(s.Xd,{btnText:"Close",handleClick:()=>{t(!e)}}),(0,n.jsx)(s.$F,{btnText:"Delete",handleClick:l})]})]})})})};var S=i(54348),z=i(32224),P=i(17507),T=i(22651),D=i(92524),F=i(96866),R=i(56543),A=i(35268),E=i(96236),q=i(29200),N=i(47533),X=i(87536),V=i(6978),H=i(43584),O=i(16310);let Q=()=>O.Ry().shape({title_vi:O.Z_().required("Please enter title"),description_vi:O.Z_().required("Please enter title"),title_en:O.Z_().required("Please enter description"),description_en:O.Z_().required("Please enter description")}),L=()=>{let[e,t]=(0,_.useRecoilState)(d.TX),[i,l]=(0,_.useRecoilState)(w.m),r=(0,_.useRecoilValue)(q.X),[c,o]=(0,m.useState)(!0),a=(0,X.cI)({defaultValues:{...i},resolver:(0,N.X)(Q())}),u=()=>{t(!e),l(null),(0,H.z8)(w.m,null),a.reset()},h=async e=>{i&&(null==i?void 0:i.id)>0?(0,b.Oq)(i.id,e,u):(0,b.mx)(e,u)},j=(0,X.qo)({name:"is_published",control:null==a?void 0:a.control});return(0,m.useEffect)(()=>{o(!0),setTimeout(()=>{o(!1)},1e3)},[r.key]),(0,n.jsx)(y.Z,{open:e,maxWidth:"lg",title:i&&(null==i?void 0:i.id)>0?"Update news & events":"Create news & events",onClose:u,children:(0,n.jsxs)(V.Yb,{onError:E.qp,onSuccess:h,formContext:a,children:[(0,n.jsxs)(x.Z,{pb:9,children:[(0,n.jsx)(z.FE,{}),c?(0,n.jsx)(z.Mi,{}):(0,n.jsxs)(x.Z,{spacing:2,children:[(0,n.jsx)(S.Y,{children:(0,n.jsxs)(x.Z,{spacing:1,children:[(0,n.jsxs)(x.Z,{direction:"row",spacing:2,children:[(0,n.jsx)(D.Z,{form:a,name:"title_".concat(r.key),label:"Title",required:!0}),(0,n.jsx)(g.Z,{width:"100%",children:(0,n.jsxs)(x.Z,{direction:"row",spacing:2,children:[(0,n.jsx)(T.xx,{form:a,name:"position",label:"Position",required:!0}),(0,n.jsx)(g.Z,{width:"100%",children:(0,n.jsx)(P.k,{formContent:a,name:"is_published",label:"Status",controlLabel:j?"Published":"Unpublished"})})]})})]}),(0,n.jsxs)(x.Z,{direction:"row",spacing:2,children:[(0,n.jsx)(D.Z,{form:a,name:"description_".concat(r.key),label:"Description",required:!0,rows:7}),(0,n.jsx)(R.f,{formContext:a,name:"thumbnail",label:"Thumbnail"})]})]})}),(0,n.jsx)(F.K,{label:"Content",formContext:a,name:"content_".concat(r.key)})]})]}),(0,n.jsxs)(A.Z,{children:[(0,n.jsx)(s.kw,{color:"inherit",onClick:u,children:"Cancel"}),(0,n.jsx)(s.kw,{type:"submit",children:"Save"})]})]})})},U=[{id:"id",title:"ID",width:10},{id:"thumbnail",title:"Thumbnail"},{id:"title_vi",title:"Title (Vi)"},{id:"title_en",title:"Title (En)"},{id:"status",title:"Status"},{id:"action",title:"",align:"right"}],W=()=>{let[e,t]=(0,_.useRecoilState)(d.NS),[i,r]=(0,_.useRecoilState)(d.TX),f=(0,_.useRecoilValue)(u.Fx),v=(0,_.useRecoilValue)(w.l),y=(0,_.useSetRecoilState)(w.m),g=e=>{r(!i),y(e)},Z=e=>{t(!0),y(e)};(0,m.useEffect)(()=>{(0,b.Qk)(f)},[f]);let k=(0,n.jsxs)(x.Z,{direction:"row",justifyContent:"space-between",children:[(0,n.jsx)(x.Z,{direction:"row",spacing:2,children:(0,n.jsx)(l.Um,{})}),(0,n.jsx)(s.xl,{btnText:"New project",handleClick:()=>{r(!i),y(null)}})]});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l._i,{headCells:U,maxHeight:"calc(100vh - 230px)",actionHeadProps:k,children:(null==v?void 0:v.length)>0&&v.map((e,t)=>{var i,l,r,s;return(0,n.jsxs)(o.T,{onClick:()=>g(e),onHandleClickDelete:()=>Z(e),children:[(0,n.jsx)(j.Z,{children:(0,h.RE)(t)}),(0,n.jsx)(j.Z,{children:(0,n.jsx)(a.F,{src:null!==(i=e.thumbnail)&&void 0!==i?i:"",height:"60px",width:"120px"})}),(0,n.jsx)(j.Z,{children:(0,n.jsx)(p(),{searchWords:[(null==f?void 0:f.keyword)?null==f?void 0:f.keyword:""],textToHighlight:null!==(l=e.title_vi)&&void 0!==l?l:""})}),(0,n.jsx)(j.Z,{children:(0,n.jsx)(p(),{searchWords:[(null==f?void 0:f.keyword)?null==f?void 0:f.keyword:""],textToHighlight:null!==(r=e.title_en)&&void 0!==r?r:""})}),(0,n.jsx)(j.Z,{children:(0,n.jsx)(c.p,{isPublished:null!==(s=null==e?void 0:e.is_published)&&void 0!==s&&s})})]},e.id)})}),i&&(0,n.jsx)(L,{}),e&&(0,n.jsx)(C,{})]})};function $(){return(0,m.useEffect)(()=>((0,H.z8)(d.Qb,[{name:"Dashboard",to:"/cp"},{name:"Projects",to:""}]),()=>{(0,H.z8)(d.Qb,[])}),[]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.$y,{title:"Project"}),(0,n.jsx)(W,{})]})}$.Layout=r.hg},23339:function(e,t,i){"use strict";i.d(t,{Oq:function(){return h},Qk:function(){return d},mx:function(){return u},u7:function(){return x}});var n=i(36985),l=i(94951),r=i(37206),s=i(80016),c=i(91444),o=i(43584),a=i(5925);let d=async e=>{let t=(0,o.$l)(a.l);return(0,o.z8)(r.RB,!((null==t?void 0:t.length)>0)),await l.m9.readProjectsApi({size:e.size,page:e.page,type:""}).then(e=>{e&&((0,o.z8)(a.l,e.items),(0,o.z8)(r.f4,e.pages?e.pages:0))}).catch(e=>(c.Am.error((0,s.t)("failSubmitForm")),Promise.reject(e))).finally(()=>{(0,o.z8)(r.RB,!1)})},u=async(e,t)=>((0,o.z8)(n._,!0),await l.m9.createProjectApi({requestBody:e}).then(()=>{c.Am.success("Created project successfully"),(0,o.z8)(r.Fx,e=>({...e,refetchData:e.refetchData&&e.refetchData+1})),t()}).catch(()=>{c.Am.error((0,s.t)("failSubmitForm"))}).finally(()=>{(0,o.z8)(n._,!1)})),h=async(e,t,i)=>((0,o.z8)(n._,!0),await l.m9.updateProjectApi({projectId:e,requestBody:t}).then(()=>{c.Am.success("Created project successfully"),(0,o.z8)(r.Fx,e=>({...e,refetchData:e.refetchData&&e.refetchData+1})),i()}).catch(()=>{c.Am.error((0,s.t)("failSubmitForm"))}).finally(()=>{(0,o.z8)(n._,!1)})),x=async e=>((0,o.z8)(n._,!0),await l.m9.deleteProjectApi({projectId:e}).then(e=>{c.Am.success(e.detail),(0,o.z8)(r.Fx,e=>({...e,refetchData:e.refetchData&&e.refetchData+1}))}).catch(e=>(c.Am.error((0,s.t)("failSubmitForm")),Promise.reject(e))).finally(()=>{(0,o.z8)(n._,!1)}))},5925:function(e,t,i){"use strict";i.d(t,{l:function(){return l},m:function(){return r}});var n=i(4480);let l=(0,n.atom)({key:"projectListState",default:[]}),r=(0,n.atom)({key:"projectActiveState",default:null})}},function(e){e.O(0,[937,216,578,737,951,118,888,774,179],function(){return e(e.s=74793)}),_N_E=e.O()}]);